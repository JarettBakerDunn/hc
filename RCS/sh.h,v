head	1.5;
access;
symbols;
locks
	becker:1.5; strict;
comment	@ * @;


1.5
date	2006.01.22.01.11.34;	author becker;	state Exp;
branches;
next	1.4;

1.4
date	2004.12.20.05.09.57;	author becker;	state Exp;
branches;
next	1.3;

1.3
date	2004.08.06.00.38.43;	author becker;	state Exp;
branches;
next	1.2;

1.2
date	2004.07.02.00.15.02;	author becker;	state Exp;
branches;
next	1.1;

1.1
date	2004.06.24.01.02.36;	author becker;	state Exp;
branches;
next	;


desc
@@


1.5
log
@*** empty log message ***
@
text
@#ifdef NEED_HEAL
/* 
   load definitions for complex variable structures, Healpix structure
   and declarations of Healpix related functions
*/
#include "myhealpix.h"
#endif
/* 
   
same for Rick's spherical harmonic routines

*/
#include "sh_rick.h"


/* 
   spherical harmonics types 
*/
#define SH_HEALPIX 0
#define SH_RICK 1


/* 

 my spherical harmonics structures


 
*/
/* 

   individual expansion
   
*/
struct sh_lms{			
  int type;			/* this is the type of expansion 

				HEALPIX: ab will be in imaginary convention

				*/
  /* have the spatial or the spherical versions been initialized? */
  my_boolean spectral_init;
  /* l_max  */
  int lmax;
  /*  bounds from above + 1 */
  int lmaxp1;
  /*  
      two ways of storing the (l,m) arrays 
  */
  int lmbig; 			/* (lmax+1)**2 */
  int lmsmall2; 		/* (exp->lmax+1)*(exp->lmax+2)for A and B */
  /* 
     number of A,B entries, and total number of entries for a
     spherical harmonics expansion set (depends on ivec)
  */
  int n_lm;
  /* 
     number of entries for the Legendre function array 
  */
  int n_plm,tn_plm;
  /* 
     number of points in each layer the spatial domain 
  */
  int npoints;
  /*

    holds the coefficients:
    
  */
#ifdef NEED_HEAL
  /* 
     for Healpix 
  */
  struct scmplx *alm_c;		/* single prec complex */
  /* 
     for HEALPIX
  */
  struct healpix_parameters heal;
#endif
  /* 
     for Rick type 
  */
  SH_RICK_PREC *alm;
  struct rick_module rick;
};
/* 

spherical harmonics model structure, this holds several spherical
harmonic expansions

*/
struct sh_lms_model{
  /* 
     number of sets 
  */
  int nset;
  /* 
     Legendre polynomial flags
  */
  my_boolean save_plm;
  /* layer indicators if nset != 1 */
  float *z;
  /* scalar only? ivec=0 or velocities? ivec=1 */
  int ivec;
  /* number of expansions per set */
  int shps;
  /* expansions  */
  struct sh_lms *exp;
  int nexp;			/* number of expansions */
  double *plm;			/* precomputed Legendre 
					   functions */

  /* 
     spatial data points
  */
  int tnpoints;			/* number of the total datapoints */
  /* data structure */
  float *data;
  my_boolean spatial_init, initialized; 
};
/* 

 compute the (l,m) index of a tighly packed array of lmsize2
 size. arrays are C style (0...lmsize2-1).  

 lmsize2 = (lmax+1)*(lmax+2), which holds all A and B coefficients
 of an expansion of maximum order lmax
 
 this assumes that A and B coefficients are stored next to each
 other. pass a_or_b as 0 or 1 for A or B coefficients, respectively
 
 0 <= l <= lmax, 0 <= m <= l, 0 <= a_or_b <= 1
 

*/
#define LM_INDEX(l,m,a_or_b) ((((l)+1)*(l)/2+(m))*2+(a_or_b))

@


1.4
log
@*** empty log message ***
@
text
@d1 1
d7 1
d70 1
d79 1
@


1.3
log
@*** empty log message ***
@
text
@d33 1
a33 1
struct lms{			
d88 1
a88 1
struct lms_model{
d104 1
a104 1
  struct lms *exp;
@


1.2
log
@*** empty log message ***
@
text
@d11 1
a11 1
#include "rick_sh.h"
d17 2
a18 2
#define HEALPIX 0
#define RICK 1
d51 2
a52 2
     total number of entries for a spherical harmonics expansion set
     (depends on ivec)
d54 5
a58 1
  int nplm,tnplm;
d79 1
a79 1
  RICK_PREC *alm;
@


1.1
log
@Initial revision
@
text
@d69 4
d76 1
a76 4
  /* 
     for HEALPIX
  */
  struct healpix_parameters heal;
@
